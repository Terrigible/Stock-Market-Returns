(function(){"use strict";function m(n){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},m(n)}function b(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function p(n,o){for(var a=0;a<o.length;a++){var c=o[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(n,_(c.key),c)}}function C(n,o,a){return o&&p(n.prototype,o),a&&p(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n}function _(n){var o=M(n,"string");return m(o)==="symbol"?o:String(o)}function M(n,o){if(m(n)!=="object"||n===null)return n;var a=n[Symbol.toPrimitive];if(a!==void 0){var c=a.call(n,o||"default");if(m(c)!=="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}(function(){var n=Object.defineProperty,o=function(i,e){for(var t in e)n(i,t,{get:e[t],enumerable:!0})},a={};o(a,{default:function(){return g}});var c=function(){function l(i,e){var t=this;b(this,l),i==null&&(i=document.createElement("div"),document.body.append(i)),this.cookieMessageElement=i,this._eventListeners=[],e=e||l.getOptionsFromDom(i),this.options=Object.assign({},e),this.options.theme=this.options.theme?"alternative":null,this.cookieInfo=this.getCookieInfo(),this.shouldShowCookieMessage()?(this.createCookieMessage(),this.showCookieMessage()):this.removeCookieMessage();var s=function(u){if(u.persisted===!0&&t.shouldShowCookieMessage()===!1)return t.removeCookieMessage()};window.addEventListener("pageshow",s),this._eventListeners.push({target:window,type:"pageshow",listener:s})}return C(l,[{key:"getCookieInfo",value:function(){var e="ft.com",t="preferences/manage-cookies";/\.ft\.com$/i.test(window.location.hostname)||(e=window.location.hostname.replace(/^(.*?)\./,""),t="preferences/cookies"),typeof this.options.manageCookiesPath=="string"&&(t=this.options.manageCookiesPath);var s=window.location.href;return{acceptUrl:"https://consent.".concat(e,"/__consent/consent-record-cookie?cookieDomain=.").concat(e),acceptUrlFallback:"https://consent.".concat(e,"/__consent/consent-record-cookie?redirect=").concat(s,"&cookieDomain=.").concat(e),manageCookiesUrl:"https://cookies.".concat(e,"/").concat(t,"?redirect=").concat(s,"&cookieDomain=.").concat(e),consentCookieName:"FTCookieConsentGDPR"}}},{key:"createCookieMessage",value:function(){var e=this,t=function(y){return'\n<div class="o-cookie-message__outer">\n	<div class="o-cookie-message__inner">\n		<div class="o-cookie-message__content">\n				'.concat(y,'\n		</div>\n		<div class="o-cookie-message__actions">\n			<div class="o-cookie-message__action o-cookie-message__action--secondary">\n				<a href="').concat(e.cookieInfo.manageCookiesUrl,'" class="o-cookie-message__link">Manage cookies</a>\n			</div>\n\n			<div class="o-cookie-message__action">\n				<a href="').concat(e.cookieInfo.acceptUrlFallback,'" class="o-cookie-message__button">\n					Accept cookies\n				</a>\n			</div>\n		</div>\n	</div>\n</div>')},s="o-cookie-message-label",r="o-cookie-message-description",u='\n<div class="o-cookie-message__heading">\n	<h2 id="'.concat(s,'">Cookies on the FT</h2>\n</div>\n<p id="').concat(r,'">\n	We use <a href="https://help.ft.com/help/legal-privacy/cookies/" class="o-cookie-message__link" target="_blank" rel="noopener">cookies</a> for a number of reasons, such as keeping FT Sites reliable and secure, personalising content and ads, providing social media features and to analyse how our Sites are used.\n</p>'),k=this.cookieMessageElement.firstElementChild,d=this.cookieMessageElement.innerHTML;k&&k.classList.contains("o-cookie-message__outer")||(d.trim()===""?(this.cookieMessageElement.innerHTML=t(u),this.cookieMessageElement.setAttribute("role","dialog"),this.cookieMessageElement.setAttribute("aria-labelledby",s),this.cookieMessageElement.setAttribute("aria-describedby",r)):this.cookieMessageElement.innerHTML=t(d))}},{key:"updateConsent",value:function(){var e=this,t=document.querySelector(".o-cookie-message__button");if(t){var s=function(u){return u.preventDefault(),e.dispatchEvent("oCookieMessage.act"),e.removeCookieMessage(),fetch(e.cookieInfo.acceptUrl,{method:"get",credentials:"include"})};t.addEventListener("click",s),this._eventListeners.push({target:t,type:"click",listener:s})}}},{key:"shouldShowCookieMessage",value:function(){return!document.cookie.includes("".concat(this.cookieInfo.consentCookieName))}},{key:"showCookieMessage",value:function(){this.cookieMessageElement.classList.add("o-cookie-message","o-cookie-message--active"),this.options.theme&&this.cookieMessageElement.classList.add("o-cookie-message--".concat(this.options.theme)),this.dispatchEvent("oCookieMessage.view"),this.updateConsent()}},{key:"removeCookieMessage",value:function(){this.dispatchEvent("oCookieMessage.close");try{this.cookieMessageElement.parentNode.removeChild(this.cookieMessageElement)}catch(e){}}},{key:"destroy",value:function(){this.cookieMessageElement.classList.remove("o-cookie-message--".concat(this.options.theme)),this._eventListeners.forEach(function(e){var t=e.target,s=e.type,r=e.listener;t.removeEventListener(s,r)})}},{key:"dispatchEvent",value:function(e){var t=new CustomEvent(e,{bubbles:!0});this.cookieMessageElement.dispatchEvent(t)}}],[{key:"getOptionsFromDom",value:function(e){return e instanceof HTMLElement?Object.keys(e.dataset).reduce(function(t,s){if(s==="oComponent")return t;var r=s.replace(/^oCookieMessage(\w)(\w+)$/,function(k,d,v){return d.toLowerCase()+v}),u=e.dataset[s];try{t[r]=JSON.parse(u.replace(/\'/g,'"'))}catch(k){t[r]=u}return t},{}):{}}},{key:"init",value:function(e,t){if(e||(e=document.body),e instanceof HTMLElement||(e=document.querySelector(e)),e instanceof HTMLElement&&/\bo-cookie-message\b/.test(e.getAttribute("data-o-component")))return new l(e,t);var s=e.querySelector('[data-o-component="o-cookie-message"]');return new l(s,t)}}]),l}(),h=c;function f(){h.init(),document.removeEventListener("o.DOMContentLoaded",f)}typeof document!="undefined"&&document.addEventListener("o.DOMContentLoaded",f);var g=h;typeof Origami=="undefined"&&(self.Origami={}),self.Origami["o-cookie-message"]=g||a})();})();
